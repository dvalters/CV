:numbered:

== Hydrological Modelling with LSDTopoTools: LSDCatchmentModel

.From https://en.wikipedia.org/wiki/The_Land_of_the_Mountain_and_the_Flood[The Land of the Mountain and the Flood]
[quote, Walter Scott, The Lay of the Last Minstrel]
O Caledonia! stern and wild, +
Meet nurse for a poetic child! +
Land of the heath and shaggy wood, +
Land of the mountain and the flood... +


=== What does this model do?

NOTE: **As of February 2016, the erosion components of this model need a bit of bug fixing. So this model is currently suitable for hydrological simulations only. (I.e. river flow, flood innundation etc.)**

It is designed to model shorter term landscape processes and evolution within indivdual catchments. The key features are a hydrologically non-steady state flow routing component. In other words, the model explicity calculates 2D water flow dynamics from rainfall input across the landscape using a simplified version of the shallow water equations. Most other LEMs calculate water fluxes based on some simplified parameterisation involving drainage area. The model timestep is typically much shorter than many LEMs and so while there is theorertically no limit to the length of timescale you wish to simulate, bear in mind that long runs over thousands of years with complex rainfall distributions will take a *long* time. The model was designed with simulating landscape response to individual storms, seasonal changes, with holocene landscape evolution as a suggested upper limit in terms of time scale.

It is designed to simulate individual catchments, with water flowing out at a single edge cell(s), so preparation of your DEM should reflect this requirement. 

==== Why not just use the original, GUI version of CAESAER-Lisflood?

You can do if you want to! If you are happy to run on Windows, and would prefer to use a model in GUI-mode then CAESAR-Lisflood is a good choice for this. This branch of the model is designed to be cross platform, though with an emphasis on running on a linux environment, and hopefully extendable to running on a supercomputer if the resources are available to you. One of the drawbacks to the original model is that you need a dedicated Windows box to do your simulations, you can't send them off to a cluster computer-type facility. (Unless you have a bunch of spare Windows PCs...)

With this version you can also perform topographic analysis within the same LSDTopoTools environment, switching easily between modelling and topographic analysis.

NOTE: This version of the model does not yet implement some of the more specialised features in CAESAR-Lisflood, such as dune modelling, river reach modelling, and so on. If you want those right now, you should go get the original model.

==== How does LSDCatchmentModel fit in with LSDRasterModel?

It should compliment the LSDRasterModel, which is better suited to large-scale, topographic evolution over long geological time periods, and has a much faster implicit solver based on Jean Braun's FastScape algorithm.

==== References
These are the two main references that explain the algorithms in more detail:

Coulthard, T. J., Neal, J. C., Bates, P. D., Ramirez, J., Almeida, G. A., & Hancock, G. R. (2013). *Integrating the LISFLOOD‚ÄêFP 2D hydrodynamic model with the CAESAR model: implications for modelling landscape evolution.* Earth Surface Processes and Landforms, 38(15), 1897-1906.

Bates, P. D., Horritt, M. S., & Fewtrell, T. J. (2010). *A simple inertial formulation of the shallow water equations for efficient two-dimensional flood inundation modelling.* Journal of Hydrology, 387(1), 33-45.

== LSDCatchmentModel: User Guide
The model runs from the command line/terminal/console. You specify the model executable name (CatchmentModel.out) followed by the path name to the parameter file and the parameter file itself. The model will print out updates to the terminal window regularly, keeping you updated to the stage it is at and if there are any errors. The DEM of your catchment must be present in the same folder as your parameter file and must be correctly formatted.

IMPORTANT: Compiling this model requires a compiler that supports the recent C\\++11 standard. (It uses features of the language not in previous standards). We test our code with *gcc*, it requries gcc version 4.7 or later. The makefile includes a flag to activate C\\++11 compatibility. 

=== Compilation with the Makefile

=== DEM preparation
Currently, you will have to prepare your own DEM as a separate stage in the workflow. (Using whichever GIS tool you like, or preferably our own software!). The DEM should be set up so that one side of the catchment will act as the flow exit point. If you do not have the intended catchment outlet point touching one of the DEM edges, you will get unrealistic pooling of water and flood the entire catchment. *In other words: There should be no 'NODATA' values between the outlet cell(s) and the edge the DEM file.* This is very important for the model to work correctly. 

NOTE: The model will actually route water flow off *all* edges of the catchment. This might be fine for what you need, but discharge timeseries file

Technically, the DEM doesn't need to be pit-filled, but it may be worthwhile to do so as parts of the model can be sped up when the catchment is in a low-flow or steady-flow state. Again, it depends on your intended usage of the model. 

=== Set up and Paramter File 
A sample parameter file is provided for the Boscastle floods simulation. This is a 48-hour simulation. It will take about 2-3 hours to run on a mid-range Desktop machine. (You can dramatically speed this up by using a coarser DEM. 









